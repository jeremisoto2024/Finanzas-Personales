<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Financiero Premium</title>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== RESET Y CONFIGURACI√ìN BASE ===== */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warning-gradient: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            --dark-bg: #0f172a;
            --dark-card: #1e293b;
            --dark-border: #334155;
            --light-text: #f8fafc;
            --muted-text: #94a3b8;
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.3);
            --shadow-sm: 0 4px 6px rgba(0, 0, 0, 0.1);
            --border-radius: 16px;
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark-bg);
            color: var(--light-text);
            min-height: 100vh;
            background-image: 
                radial-gradient(at 100% 0%, rgba(59, 130, 246, 0.15) 0px, transparent 50%),
                radial-gradient(at 0% 100%, rgba(139, 92, 246, 0.15) 0px, transparent 50%);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* ===== LOADING ANIMATION ===== */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid transparent;
            border-top-color: var(--accent-purple);
            border-right-color: var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ===== HEADER PREMIUM ===== */
        header {
            padding: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--accent-blue), transparent);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: fadeIn 0.8s ease-out;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .logo {
            font-size: 2.5rem;
            background: var(--primary-gradient);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: float 6s ease-in-out infinite;
            box-shadow: var(--shadow-lg);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .header-title h1 {
            font-family: 'Manrope', sans-serif;
            font-weight: 800;
            font-size: 2.2rem;
            background: linear-gradient(135deg, var(--light-text) 0%, var(--muted-text) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }

        .header-title p {
            color: var(--muted-text);
            font-size: 0.95rem;
            margin-top: 0.25rem;
        }

        .refresh-btn {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid var(--dark-border);
            color: var(--light-text);
            padding: 0.875rem 1.75rem;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-family: 'Inter', sans-serif;
        }

        .refresh-btn:hover {
            background: var(--dark-card);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent-blue);
        }

        /* ===== TARJETAS DE RESUMEN ===== */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }

        .summary-card {
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            border-radius: var(--border-radius);
            padding: 2rem;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary-gradient);
            opacity: 0;
            transition: var(--transition);
        }

        .summary-card:hover::before {
            opacity: 1;
        }

        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent-blue);
        }

        .summary-card.income::before {
            background: var(--success-gradient);
        }

        .summary-card.expense::before {
            background: var(--warning-gradient);
        }

        .summary-card.balance {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .card-label {
            font-size: 0.9rem;
            color: var(--muted-text);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .card-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--light-text) 0%, #cbd5e1 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .card-value.income {
            background: var(--success-gradient);
            -webkit-background-clip: text;
        }

        .card-value.expense {
            background: var(--warning-gradient);
            -webkit-background-clip: text;
        }

        .card-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.75rem;
            font-size: 0.875rem;
            color: var(--muted-text);
        }

        /* ===== SECCIONES ===== */
        section {
            margin-bottom: 3rem;
            animation: fadeInUp 0.6s ease-out;
        }

        .section-title {
            font-family: 'Manrope', sans-serif;
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-subtitle {
            color: var(--muted-text);
            font-size: 0.95rem;
            margin-bottom: 1.5rem;
        }

        /* ===== ALERTAS INTELIGENTES ===== */
        .alertas-container {
            display: grid;
            gap: 1rem;
        }

        .alerta-item {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid var(--dark-border);
            border-radius: var(--border-radius);
            padding: 1.25rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .alerta-item:hover {
            transform: translateX(5px);
            border-color: var(--accent-purple);
        }

        .alerta-icono {
            font-size: 1.5rem;
        }

        .alerta-texto {
            flex: 1;
            font-weight: 500;
        }

        .alerta-info {
            border-left: 4px solid var(--accent-blue);
        }

        .alerta-warning {
            border-left: 4px solid var(--accent-red);
        }

        .alerta-success {
            border-left: 4px solid var(--accent-green);
        }

        /* ===== PRESUPUESTOS VISUALES ===== */
        .presupuestos-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .presupuesto-card {
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            transition: var(--transition);
        }

        .presupuesto-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .presupuesto-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .presupuesto-titulo {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .presupuesto-monto {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-gradient);
            border-radius: 4px;
            transition: width 1s ease-out;
        }

        .presupuesto-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.875rem;
            color: var(--muted-text);
        }

        /* ===== PROYECCI√ìN FIN DE MES ===== */
        .proyeccion-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .proyeccion-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(15, 23, 42, 0.8));
            border: 1px solid var(--dark-border);
            border-radius: var(--border-radius);
            padding: 2rem;
            text-align: center;
            transition: var(--transition);
        }

        .proyeccion-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .proyeccion-icono {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: inline-block;
        }

        .proyeccion-valor {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
            margin: 0.5rem 0;
        }

        /* ===== GR√ÅFICOS Y LISTA DE GASTOS ===== */
        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 3rem;
        }

        @media (max-width: 1024px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        .chart-card {
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            border-radius: var(--border-radius);
            padding: 2rem;
            transition: var(--transition);
        }

        .chart-card:hover {
            box-shadow: var(--shadow-lg);
            border-color: var(--accent-blue);
        }

        .chart-title {
            font-family: 'Manrope', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        /* ===== LISTA DE GASTOS ===== */
        .expense-list {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .expense-list::-webkit-scrollbar {
            width: 6px;
        }

        .expense-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .expense-list::-webkit-scrollbar-thumb {
            background: var(--accent-blue);
            border-radius: 3px;
        }

        .expense-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: var(--transition);
        }

        .expense-item:hover {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
        }

        .expense-category {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .expense-category-icon {
            width: 36px;
            height: 36px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .expense-desc {
            font-weight: 500;
        }

        .expense-date {
            font-size: 0.875rem;
            color: var(--muted-text);
        }

        .expense-amount {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
        }

        /* ===== ESTADOS VAC√çOS ===== */
        .empty-state, .cargando {
            text-align: center;
            padding: 3rem;
            color: var(--muted-text);
            font-style: italic;
            background: rgba(255, 255, 255, 0.02);
            border-radius: var(--border-radius);
            border: 2px dashed var(--dark-border);
        }

        /* ===== ANIMACIONES ===== */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1.5rem;
                text-align: center;
            }
            
            .logo {
                margin: 0 auto;
            }
            
            .summary-grid,
            .presupuestos-container,
            .proyeccion-container {
                grid-template-columns: 1fr;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .card-value {
                font-size: 1.8rem;
            }
        }

        /* ===== EFECTOS ESPECIALES ===== */
        .glass-effect {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .highlight-glow {
            position: relative;
        }

        .highlight-glow::after {
            content: '';
            position: absolute;
            inset: -1px;
            background: linear-gradient(45deg, var(--accent-blue), var(--accent-purple));
            border-radius: inherit;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .highlight-glow:hover::after {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div id="loading" class="loading-overlay" style="display: none;">
        <div class="loading-spinner"></div>
    </div>
    
    <header class="glass-effect">
        <div class="container">
            <div class="header-content">
                <div class="header-left">
                    <div class="logo">üíé</div>
                    <div class="header-title">
                        <h1>Finanz<span style="color: #8b5cf6;">Pro</span></h1>
                        <p>Dashboard Financiero Inteligente</p>
                    </div>
                </div>
                <button id="refreshBtn" class="refresh-btn highlight-glow">
                    <i class="fas fa-sync-alt"></i>
                    <span>Actualizar Datos</span>
                </button>
            </div>
        </div>
    </header>
    
    <main>
        <div class="container">
            <!-- Tarjetas de Resumen -->
            <div class="summary-grid">
                <div class="summary-card income">
                    <div class="card-label">Total Ingresos</div>
                    <div class="card-value income" id="totalIncome">0,00 ‚Ç¨</div>
                    <div class="card-trend">
                        <i class="fas fa-arrow-up"></i>
                        <span>12% vs mes anterior</span>
                    </div>
                </div>
                <div class="summary-card expense">
                    <div class="card-label">Total Gastos</div>
                    <div class="card-value expense" id="totalExpenses">0,00 ‚Ç¨</div>
                    <div class="card-trend">
                        <i class="fas fa-arrow-down"></i>
                        <span>8% reducci√≥n</span>
                    </div>
                </div>
                <div class="summary-card balance highlight-glow">
                    <div class="card-label">Balance Disponible</div>
                    <div class="card-value balance" id="availableBalance">0,00 ‚Ç¨</div>
                    <div class="card-trend">
                        <i class="fas fa-chart-line"></i>
                        <span>Saldo positivo</span>
                    </div>
                </div>
            </div>
            
            <!-- SECCI√ìN DE ALERTAS INTELIGENTES -->
            <section class="alertas-section">
                <div class="container">
                    <h2 class="section-title">
                        <i class="fas fa-bell"></i>
                        Alertas Inteligentes
                    </h2>
                    <p class="section-subtitle">Recomendaciones basadas en tu comportamiento financiero</p>
                    <div id="alertas-container" class="alertas-container">
                        <!-- Las alertas se generar√°n aqu√≠ autom√°ticamente -->
                        <div class="alerta-item alerta-info">
                            <span class="alerta-icono">üìä</span>
                            <span class="alerta-texto">Cargando tus datos financieros...</span>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- SECCI√ìN DE PRESUPUESTOS VISUALES -->
            <section class="presupuestos-section">
                <div class="container">
                    <h2 class="section-title">
                        <i class="fas fa-chart-pie"></i>
                        Presupuestos Mensuales
                    </h2>
                    <p class="section-subtitle">Seguimiento de gastos vs tus l√≠mites establecidos</p>
                    <div id="presupuestos-container" class="presupuestos-container">
                        <!-- Los presupuestos se generar√°n aqu√≠ -->
                        <div class="cargando">Calculando tus presupuestos...</div>
                    </div>
                </div>
            </section>
            
            <!-- SECCI√ìN DE PROYECCI√ìN FIN DE MES -->
            <section class="proyeccion-section">
                <div class="container">
                    <h2 class="section-title">
                        <i class="fas fa-crystal-ball"></i>
                        Proyecci√≥n Fin de Mes
                    </h2>
                    <p class="section-subtitle">Escenarios basados en tu comportamiento actual</p>
                    <div id="proyeccion-container" class="proyeccion-container">
                        <!-- La proyecci√≥n se generar√° aqu√≠ -->
                        <div class="cargando">Calculando proyecci√≥n...</div>
                    </div>
                </div>
            </section>
            
            <!-- Gr√°ficos y Lista de Gastos -->
            <div class="charts-grid">
                <div class="chart-card glass-effect">
                    <h2 class="chart-title">
                        <i class="fas fa-chart-donut"></i>
                        Distribuci√≥n de Gastos
                    </h2>
                    <div class="chart-container">
                        <canvas id="pieChart"></canvas>
                        <div id="pieChartEmpty" class="empty-state" style="display: none;">
                            <i class="fas fa-chart-pie fa-2x"></i>
                            <p>No hay datos de gastos disponibles</p>
                        </div>
                    </div>
                </div>
                
                <div class="chart-card glass-effect">
                    <h2 class="chart-title">
                        <i class="fas fa-receipt"></i>
                        √öltimas Transacciones
                    </h2>
                    <div id="expenseList" class="expense-list">
                        <div class="empty-state">
                            <i class="fas fa-wallet fa-2x"></i>
                            <p>No hay transacciones recientes</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Configuraci√≥n global
        Chart.defaults.font.family = "'Inter', sans-serif";
        Chart.defaults.color = '#94a3b8';

        // Datos de ejemplo mejorados
        const financialData = {
            ingresos: 4850.75,
            gastos: 3120.50,
            balance: 1730.25,
            gastosPorCategoria: {
                'Alimentaci√≥n': 850.00,
                'Transporte': 420.50,
                'Entretenimiento': 320.00,
                'Servicios': 650.00,
                'Compras': 880.00
            },
            presupuestos: [
                { categoria: 'Alimentaci√≥n', presupuesto: 1000, gastado: 850, icono: 'üçî' },
                { categoria: 'Transporte', presupuesto: 500, gastado: 420.5, icono: 'üöó' },
                { categoria: 'Entretenimiento', presupuesto: 400, gastado: 320, icono: 'üé¨' },
                { categoria: 'Servicios', presupuesto: 700, gastado: 650, icono: 'üè†' },
                { categoria: 'Compras', presupuesto: 1000, gastado: 880, icono: 'üõçÔ∏è' }
            ],
            proyecciones: {
                optimista: 2105.25,
                realista: 1730.25,
                pesimista: 1255.75
            },
            transacciones: [
                { categoria: 'Alimentaci√≥n', descripcion: 'Supermercado', monto: 120.50, fecha: '2024-01-15', icono: 'üõí' },
                { categoria: 'Transporte', descripcion: 'Gasolina', monto: 65.00, fecha: '2024-01-14', icono: '‚õΩ' },
                { categoria: 'Entretenimiento', descripcion: 'Cine', monto: 45.00, fecha: '2024-01-13', icono: 'üé¨' },
                { categoria: 'Servicios', descripcion: 'Internet', monto: 75.00, fecha: '2024-01-12', icono: 'üì°' },
                { categoria: 'Compras', descripcion: 'Ropa', monto: 189.99, fecha: '2024-01-11', icono: 'üëï' },
                { categoria: 'Alimentaci√≥n', descripcion: 'Restaurante', monto: 85.50, fecha: '2024-01-10', icono: 'üçΩÔ∏è' },
                { categoria: 'Transporte', descripcion: 'Taxi', monto: 25.00, fecha: '2024-01-09', icono: 'üöñ' }
            ]
        };

        // Funciones de utilidad
        function formatCurrency(amount) {
            return new Intl.NumberFormat('es-ES', {
                style: 'currency',
                currency: 'EUR',
                minimumFractionDigits: 2
            }).format(amount);
        }

        function getPorcentajeColor(porcentaje) {
            if (porcentaje < 60) return '#10b981';
            if (porcentaje < 85) return '#f59e0b';
            return '#ef4444';
        }

        // Inicializar Dashboard
        function initDashboard() {
            showLoading();
            
            setTimeout(() => {
                updateSummaryCards();
                renderAlertas();
                renderPresupuestos();
                renderProyecciones();
                renderPieChart();
                renderExpenseList();
                hideLoading();
                
                // Agregar animaciones iniciales
                animateValue('totalIncome', 0, financialData.ingresos, 1500);
                animateValue('totalExpenses', 0, financialData.gastos, 1500);
                animateValue('availableBalance', 0, financialData.balance, 1500);
            }, 1000);
        }

        // Actualizar tarjetas de resumen
        function updateSummaryCards() {
            document.getElementById('totalIncome').textContent = formatCurrency(financialData.ingresos);
            document.getElementById('totalExpenses').textContent = formatCurrency(financialData.gastos);
            document.getElementById('availableBalance').textContent = formatCurrency(financialData.balance);
        }

        // Renderizar alertas inteligentes
        function renderAlertas() {
            const container = document.getElementById('alertas-container');
            const alertas = generarAlertasInteligentes();
            
            container.innerHTML = alertas.map(alerta => `
                <div class="alerta-item ${alerta.tipo}">
                    <span class="alerta-icono">${alerta.icono}</span>
                    <span class="alerta-texto">${alerta.mensaje}</span>
                </div>
            `).join('');
        }

        function generarAlertasInteligentes() {
            const alertas = [];
            const porcentajeGastos = (financialData.gastos / financialData.ingresos) * 100;
            
            if (porcentajeGastos > 70) {
                alertas.push({
                    icono: '‚ö†Ô∏è',
                    mensaje: 'Est√°s gastando m√°s del 70% de tus ingresos. Considera reducir gastos no esenciales.',
                    tipo: 'alerta-warning'
                });
            } else {
                alertas.push({
                    icono: '‚úÖ',
                    mensaje: '¬°Buen trabajo! Tus gastos est√°n por debajo del 70% de tus ingresos.',
                    tipo: 'alerta-success'
                });
            }
            
            if (financialData.balance > 1000) {
                alertas.push({
                    icono: 'üí∞',
                    mensaje: '¬°Excelente! Tienes un buen colch√≥n financiero. Considera invertir el excedente.',
                    tipo: 'alerta-success'
                });
            }
            
            // Encontrar categor√≠a con mayor gasto
            const maxGasto = Object.entries(financialData.gastosPorCategoria)
                .reduce((max, [cat, val]) => val > max.val ? {cat, val} : max, {val: 0});
            
            alertas.push({
                icono: 'üìä',
                mensaje: `Tu mayor gasto es en ${maxGasto.cat}: ${formatCurrency(maxGasto.val)}`,
                tipo: 'alerta-info'
            });
            
            // Verificar presupuestos excedidos
            financialData.presupuestos.forEach(presupuesto => {
                const porcentaje = (presupuesto.gastado / presupuesto.presupuesto) * 100;
                if (porcentaje > 90) {
                    alertas.push({
                        icono: 'üö®',
                        mensaje: `¬°Cuidado! Presupuesto de ${presupuesto.categoria} al ${porcentaje.toFixed(0)}%`,
                        tipo: 'alerta-warning'
                    });
                }
            });
            
            return alertas;
        }

        // Renderizar presupuestos visuales
        function renderPresupuestos() {
            const container = document.getElementById('presupuestos-container');
            
            container.innerHTML = financialData.presupuestos.map(presupuesto => {
                const porcentaje = (presupuesto.gastado / presupuesto.presupuesto) * 100;
                const color = getPorcentajeColor(porcentaje);
                
                return `
                    <div class="presupuesto-card">
                        <div class="presupuesto-header">
                            <div class="presupuesto-titulo">
                                ${presupuesto.icono} ${presupuesto.categoria}
                            </div>
                            <div class="presupuesto-monto">${formatCurrency(presupuesto.gastado)} / ${formatCurrency(presupuesto.presupuesto)}</div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" 
                                 style="width: ${Math.min(porcentaje, 100)}%; background: ${color};">
                            </div>
                        </div>
                        <div class="presupuesto-info">
                            <span>${porcentaje.toFixed(1)}% utilizado</span>
                            <span>Restante: ${formatCurrency(presupuesto.presupuesto - presupuesto.gastado)}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Renderizar proyecciones
        function renderProyecciones() {
            const container = document.getElementById('proyeccion-container');
            
            container.innerHTML = `
                <div class="proyeccion-card">
                    <div class="proyeccion-icono">üöÄ</div>
                    <h3>Optimista</h3>
                    <div class="proyeccion-valor" style="color: #10b981;">
                        ${formatCurrency(financialData.proyecciones.optimista)}
                    </div>
                    <p>Si reduces gastos en 15%</p>
                </div>
                
                <div class="proyeccion-card">
                    <div class="proyeccion-icono">üìà</div>
                    <h3>Realista</h3>
                    <div class="proyeccion-valor" style="color: #3b82f6;">
                        ${formatCurrency(financialData.proyecciones.realista)}
                    </div>
                    <p>Manteniendo el ritmo actual</p>
                </div>
                
                <div class="proyeccion-card">
                    <div class="proyeccion-icono">‚ö†Ô∏è</div>
                    <h3>Pesimista</h3>
                    <div class="proyeccion-valor" style="color: #ef4444;">
                        ${formatCurrency(financialData.proyecciones.pesimista)}
                    </div>
                    <p>Si aumentas gastos en 10%</p>
                </div>
            `;
        }

        // Renderizar gr√°fico circular
        function renderPieChart() {
            const ctx = document.getElementById('pieChart').getContext('2d');
            const data = Object.values(financialData.gastosPorCategoria);
            const labels = Object.keys(financialData.gastosPorCategoria);
            const colors = ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444'];
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: colors,
                        borderColor: colors.map(c => c + 'CC'),
                        borderWidth: 2,
                        borderRadius: 8,
                        hoverBackgroundColor: colors.map(c => c + 'DD'),
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: '#94a3b8',
                                font: {
                                    family: 'Inter',
                                    size: 14
                                },
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(30, 41, 59, 0.9)',
                            titleColor: '#f8fafc',
                            bodyColor: '#f8fafc',
                            borderColor: '#334155',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const total = data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${context.label}: ${formatCurrency(value)} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    cutout: '65%',
                    animation: {
                        animateScale: true,
                        animateRotate: true,
                        duration: 1500
                    }
                }
            });
        }

        // Renderizar lista de gastos
        function renderExpenseList() {
            const container = document.getElementById('expenseList');
            
            container.innerHTML = financialData.transacciones.map(transaccion => `
                <div class="expense-item">
                    <div class="expense-category">
                        <div class="expense-category-icon">${transaccion.icono}</div>
                        <div>
                            <div class="expense-desc">${transaccion.descripcion}</div>
                            <div class="expense-date">${new Date(transaccion.fecha).toLocaleDateString('es-ES')}</div>
                        </div>
                    </div>
                    <div class="expense-amount">${formatCurrency(transaccion.monto)}</div>
                </div>
            `).join('');
        }

        // Animaci√≥n de n√∫meros
        function animateValue(elementId, start, end, duration) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            const startText = element.textContent;
            const currency = startText.match(/[‚Ç¨$¬£]/)?.[0] || '';
            const decimalCount = (startText.match(/,\d+/)?.[0]?.length - 1) || 2;
            
            let startTimestamp = null;
            
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const easedProgress = 1 - Math.pow(1 - progress, 3); // Easing cubic
                const current = start + easedProgress * (end - start);
                
                element.textContent = formatCurrency(current);
                
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            
            window.requestAnimationFrame(step);
        }

        // Control de loading
        function showLoading() {
            document.getElementById('loading').style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        // Bot√≥n de actualizaci√≥n
        document.getElementById('refreshBtn').addEventListener('click', () => {
            showLoading();
            setTimeout(() => {
                initDashboard();
                // Efecto visual de actualizaci√≥n
                const btn = document.getElementById('refreshBtn');
                btn.style.transform = 'rotate(360deg)';
                setTimeout(() => {
                    btn.style.transform = 'rotate(0deg)';
                }, 500);
            }, 800);
        });

        // Inicializar al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            initDashboard();
            
            // Efectos de entrada
            setTimeout(() => {
                const elements = document.querySelectorAll('.summary-card, .chart-card, .alerta-item, .presupuesto-card, .proyeccion-card');
                elements.forEach((el, i) => {
                    el.style.animation = 'fadeInUp 0.6s ease-out';
                    el.style.animationDelay = `${i * 0.1}s`;
                    el.style.animationFillMode = 'both';
                });
            }, 100);
        });
    </script>
</body>
</html>